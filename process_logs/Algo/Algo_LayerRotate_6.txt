###########
## n = 6 ##
###########

limit = 3
layer = [0, 1, 2, 3]
first = [0, 1, 2, 3]
last = [5-0, 5-1, 5-2, 5-3]
     = [ 5,   6,   7,   8 ]

